<!DOCTYPE html>
<html lang="en-US" itemscope="itemscope" itemtype="https://schema.org/WebPage" class="<%- locals.sitePalette %>">
<head>
  <% if (!locals.sitePalette) { %>
  <script>
    function setSitePalette() {
      var palettes = [
        'blue',
        'blue-grey',
        'cyan',
        'deep-orange',
        'deep-purple',
        'green',
        'grey',
        'indigo',
        'orange',
        'purple',
        'red',
        'teal',
      ];
      var paletteIndex = Math.floor(Math.random() * palettes.length);
      var palette = palettes[paletteIndex];
      var urlParams = new URLSearchParams(window.location.search);

      if (urlParams.has('palette')) {
        palette = urlParams.get('palette');
      }

      document.documentElement.classList.add(palette);

      window.requestAnimationFrame(() => {
        var paletteHex = getComputedStyle(document.documentElement).getPropertyValue('--primary-color');
        paletteHex = paletteHex.replace(/\s/g, '');
        document.querySelector('meta[name="theme-color"]').setAttribute('content', paletteHex);
      });
    }
    setSitePalette();
  </script>
  <% } %>
  <%- partial('meta', locals); %>
  <script>
    window.onerror = function (msg, url, lineNo, columnNo, error) {
      var string = msg.toLowerCase();
      var message = [
        'Message: ' + msg,
        'URL: ' + url,
        'Line: ' + lineNo,
        'Column: ' + columnNo,
        'Error object: ' + JSON.stringify(error)
      ].join(' - ');

      dataLayer.push({
        event: 'gaEvent',
        gaCategory: 'javascript error',
        gaAction: message,
      });
    };
  </script>
</head>
<body>
  <% if(!locals.devBuild) { %>
    <%# Google Tag Manager (noscript); %>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5KZW4HX" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <%# End Google Tag Manager (noscript); %>
  <% } %>
  <%- content %>
</body>
</html>
